name: V√©rification des fichiers sur le FTP

on:
  workflow_dispatch:
  push:
    branches: [main]

jobs:
  verify-ftp:
    runs-on: ubuntu-latest

    steps:
      - name: Attendre 2 minutes pour laisser le d√©ploiement se terminer
        run: sleep 120

      - name: Installer lftp
        run: sudo apt-get update && sudo apt-get install -y lftp

      - name: V√©rifier la pr√©sence des fichiers sur le FTP
        env:
          FTP_HOST: ${{ secrets.FTP_HOST }}
          FTP_USER: ${{ secrets.FTP_USERNAME }}
          FTP_PASS: ${{ secrets.FTP_PASSWORD }}
        run: |
          lftp -u "$FTP_USER","$FTP_PASS" "$FTP_HOST" <<EOF
          set ssl:verify-certificate no

          echo "üîç V√©rification des fichiers principaux HTML..."
          cls -1 public_html/index.html        || (echo "‚ùå index.html manquant" && exit 1)
          cls -1 public_html/cv.html           || (echo "‚ùå cv.html manquant" && exit 1)
          cls -1 public_html/projects.html     || (echo "‚ùå projects.html manquant" && exit 1)
          cls -1 public_html/reseaux.html      || (echo "‚ùå reseaux.html manquant" && exit 1)
          cls -1 public_html/blog.html         || (echo "‚ùå blog.html manquant" && exit 1)
          cls -1 public_html/home.html         || (echo "‚ùå home.html manquant" && exit 1)

          echo "üîç V√©rification des fichiers de styles..."
          cls -1 public_html/styles/style.css         || (echo "‚ùå style.css manquant" && exit 1)
          cls -1 public_html/styles/index.css         || (echo "‚ùå index.css manquant" && exit 1)
          cls -1 public_html/styles/cv.css            || (echo "‚ùå cv.css manquant" && exit 1)
          cls -1 public_html/styles/projects.css      || (echo "‚ùå projects.css manquant" && exit 1)
          cls -1 public_html/styles/home.css          || (echo "‚ùå home.css manquant" && exit 1)
          cls -1 public_html/styles/blog.css          || (echo "‚ùå blog.css manquant" && exit 1)
          cls -1 public_html/styles/article.css       || (echo "‚ùå article.css manquant" && exit 1)
          cls -1 public_html/styles/subproject.css    || (echo "‚ùå subproject.css manquant" && exit 1)
          cls -1 public_html/styles/reseaux.css       || (echo "‚ùå reseaux.css manquant" && exit 1)

          echo "üîç V√©rification des scripts JS..."
          cls -1 public_html/scripts/script.js        || (echo "‚ùå script.js manquant" && exit 1)

          echo "üîç V√©rification des assets..."
          cls -1 public_html/assets/Thibault.png               || (echo "‚ùå Thibault.png manquant" && exit 1)
          cls -1 public_html/assets/Untitled.png               || (echo "‚ùå Untitled.png manquant" && exit 1)
          cls -1 public_html/assets/icons/logo.png             || (echo "‚ùå logo.png manquant" && exit 1)
          cls -1 public_html/assets/icons/docker.svg           || (echo "‚ùå docker.svg manquant" && exit 1)
          cls -1 public_html/assets/icons/python.svg           || (echo "‚ùå python.svg manquant" && exit 1)
          cls -1 public_html/assets/icons/nodejs.svg           || (echo "‚ùå nodejs.svg manquant" && exit 1)
          cls -1 public_html/assets/icons/csharp.svg           || (echo "‚ùå csharp.svg manquant" && exit 1)
          cls -1 public_html/assets/icons/git.svg              || (echo "‚ùå git.svg manquant" && exit 1)
          cls -1 public_html/assets/icons/ocaml.svg            || (echo "‚ùå ocaml.svg manquant" && exit 1)

          echo "üîç V√©rification des sous-pages projet/blog..."
          cls -1 public_html/blogs/article1.html               || (echo "‚ùå article1.html manquant" && exit 1)
          cls -1 public_html/projects/syndromefear.html        || (echo "‚ùå syndromefear.html manquant" && exit 1)

          echo "‚úÖ Tous les fichiers attendus sont pr√©sents sur le serveur FTP."
          quit
          EOF
